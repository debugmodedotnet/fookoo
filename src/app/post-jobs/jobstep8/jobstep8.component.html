<div class="job-details py-5">
  <h3 class="font-family-poppins mb-4 font-30 font-992-28 text-center">
    @if(editMode){ Edit the job details you wish to change.} @else { ðŸŽ‰
    Congratulations your job has been created!}
  </h3>

  @if(!editMode){
  <div class="job-detail-content">
    <div class="wrapper rounded-4 nmc-bg-white">
      <div class="company-info p-4 border-bottom position-relative">
        <!-- <div class="company-img position-absolute">
          <a [href]="job?.CompanyUrl"
            ><img
              [src]="job?.ImageUrl ? job?.ImageUrl : defaultImage"
              alt="{{ job?.position }}"
              class="h-100 w-100 object-fit-contain"
          /></a>          
        </div> -->

        <div class="d-flex align-items-start justify-content-between">
          <div>
            <h2 class="font-32 nmc-dark-grey fw-normal">
              {{ job?.position }}
            </h2>

            <div
              class="pt-3 d-flex align-items-center justify-content-start gap-4"
            >
              <a [href]="job?.CompanyUrl">
                <h6 class="nmc-medium-grey fw-light font-16 m-0">
                  <i class="bi bi-buildings me-2 font-20"></i
                  >{{ job?.companyName }}
                </h6></a
              >

              @if( job?.Location){
              <h6 class="nmc-medium-grey fw-light font-16 m-0">
                <i class="bi bi-geo-alt me-2 font-20"></i>{{ job?.Location }}
              </h6>
              }

              <h6 class="nmc-medium-grey fw-light font-16 m-0">
                <i class="bi bi-laptop me-2 font-20"></i>
                {{ job?.jobType }}
              </h6>

              <!-- @if(job?.email){
              <h6 class="nmc-medium-grey fw-light font-16 m-0">
                <i class="bi bi-envelope me-2 font-20"></i>{{ job?.email }}
              </h6>
              } @if(job?.PhoneNo){
              <h6 class="nmc-medium-grey fw-light font-16 m-0">
                <i class="bi bi-telephone me-2 font-20"></i>{{ job?.PhoneNo }}
              </h6>
              } -->
            </div>
          </div>

          <div class="d-flex align-items-center justify-content-end">
            <button
              class="nmc-btn-primary h-auto py-2 px-4 rounded-2 box-shadow-none"
              (click)="editJob(job)"
            >
              Edit
            </button>

            <a
              class="cursor-pointer"
              type="button"
              data-bs-toggle="modal"
              data-bs-target="#jobModal"              
              tabindex="0"
              ><i class="bi bi-share-fill nmc-medium-grey ms-3 font-20"></i
            ></a>
          </div>
        </div>
      </div>

      <!-- Description -->
      @if( job?.JobDescription){
      <div class="about p-4 border-bottom">
        <h5 class="nmc-dark-grey fw-semibold font-18">About the job :</h5>
        <p
          class="mt-3 nmc-medium-grey m-0 text-break"
          [innerHTML]="job?.JobDescription"
        ></p>
      </div>
      }

      <!-- Qualification -->
      @if( job?.qualification){
      <div class="qualification p-4 border-bottom">
        <h5 class="nmc-dark-grey fw-semibold font-18">
          Qualification for the job :
        </h5>
        <p class="mt-3 nmc-medium-grey m-0">{{ job?.qualification }}</p>
      </div>
      }

      <!-- Skills -->
      @if( job?.SkillsRequired){
      <div class="skills p-4 border-bottom">
        <h5 class="nmc-dark-grey fw-semibold font-18">Skills :</h5>
        <div class="d-flex align-center gap-2">
          @for(skill of job?.SkillsRequired; track skill){
          <p
            class="fw-semibold py-2 px-3 text-red-600 bg-orange-100 rounded-5 font-14 m-0 mt-2"
          >
            {{ skill }}
          </p>
          }
        </div>
      </div>
      }

      <!-- Responsibilities -->
      @if( job?.Responsibilities){
      <div class="responsibility p-4 border-bottom">
        <h5 class="nmc-dark-grey fw-semibold font-18">Responsibilities:</h5>
        <ul class="mt-3">
          @for(responsibility of job?.Responsibilities; track responsibility){
          <li class="ms-4 nmc-medium-grey">{{ responsibility }}</li>
          }
        </ul>
      </div>
      }

      <!-- Social -->
      <div class="social p-4">
        <h5 class="nmc-dark-grey fw-semibold font-18">Social Media:</h5>

        <div class="d-flex align-items-center justify-content-start gap-3">
          @if (job?.CompanyTwitter || job?.CompanyLinkedIn ||
          job?.CompanyGithub) { @if(job?.CompanyTwitter){
          <a [href]="job?.CompanyTwitter" class="font-18 nmc-medium-grey"
            ><i class="bi bi-twitter-x"></i></a
          >} @if(job?.CompanyLinkedIn){
          <a [href]="job?.CompanyLinkedIn" class="font-18 nmc-medium-grey"
            ><i class="bi bi-linkedin"></i></a
          >} @if(job?.CompanyGithub){
          <a [href]="job?.CompanyGithub" class="font-18 nmc-medium-grey"
            ><i class="bi bi-github"></i></a
          >} }@else {
          <p class="font-14 nmc-medium-grey">Not Available.</p>
          }
        </div>
      </div>
    </div>

    <!-- Job Share Modal -->
    <div
      class="modal fade"
      id="jobModal"
      tabindex="-1"
      aria-labelledby="jobModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title font-18" id="jobModalLabel">Share</h1>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>

          <div class="modal-body">
            <div class="share-options d-flex align-items-center gap-4">
              <a class="cursor-pointer linkedin" (click)="shareOnLinkedIn()">
                <i class="bi bi-linkedin font-30"></i>
              </a>

              <a class="cursor-pointer whatsapp" (click)="shareOnWhatsApp()">
                <i class="bi bi-whatsapp font-30"></i>
              </a>

              <a class="cursor-pointer twitter" (click)="shareOnTwitter()">
                <i class="bi bi-twitter-x font-30"></i>
              </a>

              <a class="cursor-pointer instagram" (click)="shareOnInstagram()">
                <i class="bi bi-instagram font-30"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  }

  <!-- Jobs Edit Form -->
  @if(editMode){
  <div class="wrapper rounded-4 nmc-bg-white p-4">
    <form [formGroup]="jobForm" (ngSubmit)="updateJob()">
      <div class="row mb-3 align-items-end">
        <!-- Company Name -->
        <div class="col-md-6">
          <label
            for="CompanyName"
            class="form-label fw-semibold font-14 required"
            >Company Name</label
          >
          <input
            id="companyName"
            type="text"
            formControlName="companyName"
            class="form-control h-3 rounded-3 cursor-pointer"
            placeholder="Enter your company name"
            readonly
          />
        </div>

        <!-- Position -->
        <div class="col-md-6">
          <label for="Position" class="form-label fw-semibold font-14 required"
            >Position</label
          >

          <input
            id="position"
            type="text"
            formControlName="position"
            class="form-control h-3 rounded-3 cursor-pointer"
            placeholder="Select your company position"
            readonly
          />

          <!-- <select
            id="position"
            formControlName="position"
            class="form-select h-3 rounded-3 cursor-pointer"
            readonly
          >
            <option value="" selected class="font-24">Select position</option>
            @for(position of positions; track position;){
            <option [value]="position" class="font-24">{{ position }}</option>
            }
          </select> -->
        </div>

        <!-- Tagline Name -->
        <!-- <div class="col-md-12 mt-3">
          <label for="tagline" class="form-label fw-semibold font-14 required"
            >Tagline</label
          >
          <input
            id="tagline"
            type="text"
            formControlName="tagline"
            class="form-control h-3 rounded-3 cursor-pointer"
            placeholder="Enter tagline"
          />
        </div> -->

        <!-- Company URL -->
        <div class="col-md-5 mt-3">
          <label
            for="CompanyUrl"
            class="form-label fw-semibold font-14 required"
            >Company URL</label
          >
          <input
            id="CompanyUrl"
            type="text"
            formControlName="CompanyUrl"
            class="form-control h-3 rounded-3 cursor-pointer"
            placeholder="Enter your company's URL"
          />

          <!-- Display validation errors -->
          @if(jobForm.get('CompanyUrl')?.invalid &&
          (jobForm.get('CompanyUrl')?.dirty ||
          jobForm.get('CompanyUrl')?.touched)){
          <div class="nmc-alert mt-1">
            @if(jobForm.get('CompanyUrl')?.errors?.['required']){
            <p class="font-14 m-0">*Please enter your Company's Url</p>
            } @if(jobForm.get('CompanyUrl')?.errors?.['pattern']){
            <p class="font-14 m-0">*Invalid Url format</p>
            }
          </div>
          }
        </div>

        <!-- Location -->
        <div class="col-md-4 mt-3">
          <label for="Location" class="form-label fw-semibold font-14 required"
            >Location</label
          >
          <input
            id="Location"
            type="text"
            formControlName="Location"
            class="form-control h-3 rounded-3 cursor-pointer"
            placeholder="Enter your company location"
          />

          <!-- Display validation errors -->
          @if(jobForm.get('Location')?.invalid &&
          (jobForm.get('Location')?.dirty || jobForm.get('Location')?.touched)){
          <div class="nmc-alert mt-1">
            @if(jobForm.get('Location')?.errors?.['required']){
            <p class="font-14 m-0">*Please enter a Location</p>
            }@if(jobForm.get('Location')?.errors?.['minlength']){
            <p class="font-14 m-0">
              *Location must be at least 3 characters long
            </p>
            }
          </div>
          }
        </div>

        <!-- Job Type -->
        <div class="col-md-3 mt-3">
          <label for="jobType" class="form-label fw-semibold font-14 required"
            >Job Type</label
          >
          <select
            id="jobType"
            formControlName="jobType"
            class="form-select rounded-3 h-3 cursor-pointer"
          >
            <option value="" selected>Select job type</option>
            @for(jobType of jobTypes; track jobType;){
            <option [value]="jobType">{{ jobType }}</option>
            }
          </select>

          <!-- Display validation errors -->
          @if(jobForm.get('jobType')?.invalid && (jobForm.get('jobType')?.dirty
          || jobForm.get('jobType')?.touched)){
          <div class="nmc-alert mt-1">
            @if(jobForm.get('jobType')?.errors?.['required']){
            <p class="font-14 m-0">*Please select a job type</p>
            }
          </div>
          }
        </div>

        <!-- Qualification -->
        <div class="col-md-6 mt-3">
          <label
            for="qualification"
            class="form-label fw-semibold font-14 required"
            >Qualification</label
          >
          <select
            id="qualification"
            formControlName="qualification"
            class="form-select rounded-3 h-3 cursor-pointer"
          >
            <option value="" selected>Select qualification</option>
            @for(qualification of qualifications; track qualification;){
            <option [value]="qualification">{{ qualification }}</option>
            }
          </select>

          <!-- Display validation errors -->
          @if(jobForm.get('qualification')?.invalid &&
          (jobForm.get('qualification')?.dirty ||
          jobForm.get('qualification')?.touched)){
          <div class="nmc-alert mt-1">
            @if(jobForm.get('qualification')?.errors?.['required']){
            <p class="font-14 m-0">*Please select a Qualification</p>
            }
          </div>
          }
        </div>

        <!-- Tech Tag -->
        <div class="col-md-6 mt-3">
          <label for="Tag" class="form-label fw-semibold font-14 required"
            >Technology Tag</label
          >
          <select
            id="Tag"
            formControlName="Tag"
            class="form-select rounded-3 h-3 cursor-pointer"
          >
            <option value="" selected>Select tag</option>
            @for(tag of tags; track tag;){
            <option [value]="tag">{{ tag }}</option>
            }
          </select>

          <!-- Display validation errors -->
          @if(jobForm.get('Tag')?.invalid && (jobForm.get('Tag')?.dirty ||
          jobForm.get('Tag')?.touched)){
          <div class="nmc-alert mt-1">
            @if(jobForm.get('Tag')?.errors?.['required']){
            <p class="font-14 m-0">*Please select a Tag</p>
            }
          </div>
          }
        </div>

        <!-- Skills -->
        <div class="col-md-12 mt-3">
          <label for="Skills" class="form-label fw-semibold font-14 required"
            >Select Skills</label
          >

          <div class="row g-3">
            @for(skill of availableSkills; track skill ){
            <div class="col-auto">
              <div
                class="chips rounded-5 py-2 px-3 text-center cursor-pointer"
                [class.selected]="isSelected(skill)"
                (click)="toggleSkill(skill)"
                (keydown)="toggleSkill(skill)"
                tabindex="0"
              >
                {{ skill }}
              </div>
            </div>
            }
          </div>

          @if(minSkillsError){
          <div class="nmc-alert mt-1">
            <p class="font-14 m-0">Please select at least 1 skill</p>
          </div>
          } @if(maxSkillsError){
          <div class="nmc-alert mt-1">
            <p class="font-14 m-0">You can select a maximum of 3 skills</p>
          </div>
          }
        </div>

        <!-- Responsibilities -->
        <div class="col-md-12 mt-3">
          <label
            for="Responsibilities"
            class="form-label fw-semibold font-14 required"
            >Responsibilities</label
          >

          @if(responsibilities.length>0){
          <div class="chip-container mb-2 row g-4">
            @for(control of responsibilities.controls; track control; let i =
            $index;){
            <ng-container>
              <div class="col-4">
                <div
                  class="chip rounded-4 d-flex align-items-start justify-content-between"
                >
                  <p class="m-0 word-break">{{ control.value }}</p>

                  <div class="d-flex align-items-center ms-5">
                    <button
                      type="button"
                      (click)="editResponsibility(i)"
                      class="p-0 border-0 nmc-dark-grey cursor-pointer"
                    >
                      <i class="bi bi-pencil-fill"></i>
                    </button>

                    <button
                      type="button"
                      (click)="removeResponsibility(i)"
                      class="p-0 ms-2 border-0 nmc-primary cursor-pointer"
                    >
                      <i class="bi bi-x-circle-fill"></i>
                    </button>
                  </div>
                </div>
              </div>
            </ng-container>
            }
          </div>
          }

          <div
            formArrayName="Responsibilities"
            class="d-flex align-items-center"
          >
            <div class="d-flex flex-wrap align-items-center w-100">
              <input
                #newResponsibility
                type="text"
                class="form-control h-3 rounded-3 cursor-pointer"
                [value]="
                  editingIndex === -1
                    ? ''
                    : responsibilities.at(editingIndex).value || ''
                "
              />
            </div>

            <button
              type="button"
              (click)="addResponsibility(newResponsibility)"
              class="nmc-btn-primary ms-3"
            >
              +
            </button>
          </div>

          <!-- Display validation errors -->
          @if(responsibilities.at(editingIndex).invalid &&
          (responsibilities.at(editingIndex).dirty ||
          responsibilities.at(editingIndex).touched)){
          <div class="nmc-alert mt-1">
            @if(editingIndex !== -1){
            <p class="font-14 m-0">
              *Please provide at least one Responsibility
            </p>
            }
          </div>
          }
        </div>

        <!-- Min Salary -->
        <div class="col-md-6 mt-3">
          <label for="MinSalary" class="form-label fw-semibold font-14 required"
            >Minimum Salary</label
          >
          <input
            id="MinSalary"
            type="number"
            formControlName="MinSalary"
            class="form-control h-3 rounded-3 cursor-pointer"
            placeholder="Enter minimum salary"
          />

          <!-- Display validation errors -->
          @if(jobForm.get('MinSalary')?.touched){
          <div class="nmc-alert mt-1">
            @if(jobForm.get('MinSalary')?.errors?.['required'] &&
            jobForm.get('MinSalary')?.touched){
            <p class="font-14 m-0">*Please enter a Minimum Salary</p>
            } @if(jobForm.errors?.['minSalaryError'] &&
            !jobForm.get('MinSalary')?.errors?.['required']){
            <p class="font-14 m-0">Minimum Salary should be at least 10,000.</p>
            }
          </div>
          }
        </div>

        <!-- Max Salary -->
        <div class="col-md-6 mt-3">
          <label for="MaxSalary" class="form-label fw-semibold font-14 required"
            >Maximum Salary</label
          >
          <input
            id="MaxSalary"
            type="number"
            formControlName="MaxSalary"
            class="form-control h-3 rounded-3 cursor-pointer"
            placeholder="Enter maximum salary"
          />

          <!-- Display validation errors -->
          @if(jobForm.get('MaxSalary')?.touched){
          <div class="nmc-alert mt-1">
            @if(jobForm.get('MaxSalary')?.errors?.['required'] &&
            jobForm.get('MaxSalary')?.touched){
            <p class="font-14 m-0">*Please enter a Minimum Salary</p>
            } @if(jobForm.errors?.['salError'] &&
            !jobForm.get('MaxSalary')?.errors?.['required']){
            <p class="font-14 m-0">
              Maximum Salary should be greater than Minimum Salary.
            </p>
            }
          </div>
          }
        </div>

        <!-- Description -->
        <div class="col-md-12 mt-3">
          <label
            for="JobDescription"
            class="form-label fw-semibold font-14 required"
            >Job Description</label
          >
          <!-- <textarea
            id="JobDescription"
            type="text"
            formControlName="JobDescription"
            class="form-control rounded-3 cursor-pointer"
            placeholder="Enter job's description"
            rows="4"
          ></textarea> -->

          <quill-editor
            formControlName="JobDescription"
            [modules]="{ toolbar: true }"
            style="height: 200px"
            placeholder="Enter job's description"
          ></quill-editor>

          <!-- Display validation errors -->
          @if(jobForm.get('JobDescription')?.invalid &&
          (jobForm.get('JobDescription')?.dirty ||
          jobForm.get('JobDescription')?.touched)){
          <div class="nmc-alert mt-1">
            @if(jobForm.get('JobDescription')?.errors?.['required']){
            <p class="font-14 m-0">*Please enter a Job Description</p>
            }@if(jobForm.get('JobDescription')?.errors?.['minlength']){
            <p class="font-14 m-0">
              *Job Description must be at least 300 characters long
            </p>
            }
          </div>
          }
        </div>

        <!-- LinkedIn -->
        <div class="col-md-4 mt-3">
          <label for="CompanyLinkedIn" class="form-label fw-semibold font-14"
            >Company LinkedIn</label
          >
          <input
            id="CompanyLinkedIn"
            type="text"
            formControlName="CompanyLinkedIn"
            class="form-control h-3 rounded-3 cursor-pointer"
            placeholder="Enter your company's linkedIn"
          />

          <!-- Display validation errors -->
          @if(jobForm.get('CompanyLinkedIn')?.invalid &&
          (jobForm.get('CompanyLinkedIn')?.dirty ||
          jobForm.get('CompanyLinkedIn')?.touched)){
          <div class="nmc-alert mt-1">
            @if(jobForm.get('CompanyLinkedIn')?.errors?.['pattern']){
            <p class="font-14 m-0">*Invalid LinkedIn format</p>
            }
          </div>
          }
        </div>

        <!-- Github -->
        <div class="col-md-4 mt-3">
          <label for="CompanyGithub" class="form-label fw-semibold font-14"
            >Company Github</label
          >
          <input
            id="CompanyGithub"
            type="text"
            formControlName="CompanyGithub"
            class="form-control h-3 rounded-3 cursor-pointer"
            placeholder="Enter your company's github"
          />

          <!-- Display validation errors -->
          @if(jobForm.get('CompanyGithub')?.invalid &&
          (jobForm.get('CompanyGithub')?.dirty ||
          jobForm.get('CompanyGithub')?.touched)){
          <div class="nmc-alert mt-1">
            @if(jobForm.get('CompanyGithub')?.errors?.['pattern']){
            <p class="font-14 m-0">*Invalid Github format</p>
            }
          </div>
          }
        </div>

        <!-- Twitter -->
        <div class="col-md-4 mt-3">
          <label for="CompanyTwitter" class="form-label fw-semibold font-14"
            >Company Twitter</label
          >
          <input
            id="CompanyTwitter"
            type="text"
            formControlName="CompanyTwitter"
            class="form-control h-3 rounded-3 cursor-pointer"
            placeholder="Enter your company's twitter"
          />

          <!-- Display validation errors -->
          @if(jobForm.get('CompanyTwitter')?.invalid &&
          (jobForm.get('CompanyTwitter')?.dirty ||
          jobForm.get('CompanyTwitter')?.touched)){
          <div class="nmc-alert mt-1">
            @if(jobForm.get('CompanyTwitter')?.errors?.['pattern']){
            <p class="font-14 m-0">*Invalid Twitter format</p>
            }
          </div>
          }
        </div>

        <!-- Is Active -->
        <div class="col-md-4 mt-3">
          <input
            id="isActive"
            formControlName="isActive"
            type="checkbox"
            class="form-check-input"
          />
          <label for="isActive" class="form-label fw-semibold font-14 ms-2"
            >Active</label
          >
        </div>
      </div>

      <div class="mt-4 d-flex justify-content-end">
        <button
          type="button"
          (click)="cancelEdit()"
          class="nmc-btn-primary nmc-bg-dark-grey font-14 fw-semibold box-shadow-none py-2"
        >
          Cancel
        </button>

        <button
          type="submit"
          class="nmc-btn-primary font-14 fw-semibold box-shadow-none py-2 ms-3"
          [disabled]="!jobForm.valid"
        >
          Update
        </button>
      </div>
    </form>
  </div>
  }
</div>
